import numpy as np
import matplotlib.pyplot as plt
import math

regionsBudget = 70

def w1Formula(x1, x2, x3):
    return (0.33333 - (x2 * x2)/(2 * (x2 - x3)) + (x3 * x2 * x2) / (x2 - x3) - x3 * x3 + x3 * x3 / (2 * (x2 - x3)) - x3 * x3 * x3 / (x2 - x3)) / (x1 * x1 - x3 * x3 + (x1 - x3) * (x3 * x3 - x2 * x2) / (x2 - x3))

def foo(x):
    return 0.2 * math.sin(100*x) + 0.1 * math.sin(40*x) - 2 * (x - 0.6) * (x-0.6) + 0.15 * math.cos(30*x) + 1

def pdf(x):
    #return -3 * (x - 0.5) ** 2 + 1.25
    return -1.786 * x * x + 2.099 * x + 0.546
    #return -1.4067136589943 * x * x + 1.65308956 * x + 0.43

def cdf(x):
    #return -1/8.0 - (x - 0.5) ** 3 + 1.25*x
    return -0.595 * x * x * x + 1.05 * x * x + 0.546 * x
    #return -0.468904553 * x * x * x + 0.82654478 * x * x + 0.43 * x

def invCdf(x):
    start = 0
    end = 1.0
    tempY = (start + end) / 2
    tempX = cdf(tempY)
    while abs(tempX - x) > 0.0001:
        tempY = (start + end) / 2
        tempX = cdf(tempY)
        if tempX > x:
            end = tempY
        else:
            start = tempY 
    return tempY

def primaryFoo(x):
    return foo(invCdf(x)) / pdf(invCdf(x))
    #return 3
    #return invCdf(x)

fooCoefs = [0.72624924279789049297,68.285299109335554135,0.91533935660223864073,46.64767980708291617,0.59432415873886235147,37.477020441523684724,0.51535824939423646729,55.406018503334408365]
def foo2(x):
    return fooCoefs[0] * math.sin(fooCoefs[1] * x) + fooCoefs[2] * math.sin(fooCoefs[3] * x) + fooCoefs[4] * math.cos(fooCoefs[5] * x) + fooCoefs[6] * math.cos(fooCoefs[7] * x)

def determinant(a, b, c, d, e, f, g, h, i):
    return a * (e*i - h*f) - b * (d*i - g*f) + c * (d*h - g*e)

def polyInt(start, end, a, b, c):
    a /= 3
    b /= 2
    integral = 0
    integral += a * end * end * end
    integral += b * end * end
    integral += c * end
    integral -= a * start * start * start
    integral -= b * start * start
    integral -= c * start
    return integral

def getCoefs(x1, x3, testFunc, coefs):
    x2 = (x1 + x3) / 2.0
    y1 = testFunc(x1)
    y2 = testFunc(x2)
    y3 = testFunc(x3)

    D = determinant(x1*x1, x1, 1, x2*x2, x2, 1, x3*x3, x3, 1)
    Da = determinant(y1, x1, 1, y2, x2, 1, y3, x3, 1)
    Db = determinant(x1*x1, y1, 1, x2*x2, y2, 1, x3*x3, y3, 1)
    Dc = determinant(x1*x1, x1, y1, x2*x2, x2, y2, x3*x3, x3, y3)

    a = 0
    b = 0
    c = 0
    if (D == 0):
        a = 0
        b = 0
        c = y2
    else:
        a = Da / D
        b = Db / D
        c = Dc / D
    coefs[0] = a
    coefs[1] = b
    coefs[2] = c

def pdf2(x):
    pdfCoefs = [0,0,0]
    getCoefs(0,1,foo2,pdfCoefs)
    minValX = 0
    if pdfCoefs[0] < 0:
        minValX = 0
        if (pdfCoefs[0] * minValX * minValX + pdfCoefs[1] * minValX + pdfCoefs[2] > pdfCoefs[0] * 1 * 1 + pdfCoefs[1] * 1 + pdfCoefs[2]):
            minValX = 1
    else:
        minValX = -pdfCoefs[1] / (2 * pdfCoefs[0])
    minVal = pdfCoefs[0] * minValX * minValX + pdfCoefs[1] * minValX + pdfCoefs[2]
    if minVal < 0:
        pdfCoefs[2] -= minVal
    tempIntegral = polyInt(0,1,pdfCoefs[0],pdfCoefs[1],pdfCoefs[2])
    #print(tempIntegral)
    pdfCoefs[0] /= tempIntegral
    pdfCoefs[1] /= tempIntegral
    pdfCoefs[2] /= tempIntegral
    return pdfCoefs[0] * x * x + pdfCoefs[1] * x + pdfCoefs[2]

def cdf2(x):
    pdfCoefs = [0,0,0]
    getCoefs(0,1,foo2,pdfCoefs)
    minValX = 0
    if pdfCoefs[0] < 0:
        minValX = 0
        if (pdfCoefs[0] * minValX * minValX + pdfCoefs[1] * minValX + pdfCoefs[2] > pdfCoefs[0] * 1 * 1 + pdfCoefs[1] * 1 + pdfCoefs[2]):
            minValX = 1
    else:
        minValX = -pdfCoefs[1] / (2 * pdfCoefs[0])
    minVal = pdfCoefs[0] * minValX * minValX + pdfCoefs[1] * minValX + pdfCoefs[2]
    if minVal < 0:
        pdfCoefs[2] -= minVal
    tempIntegral = polyInt(0,1,pdfCoefs[0],pdfCoefs[1],pdfCoefs[2])
    pdfCoefs[0] /= tempIntegral
    pdfCoefs[1] /= tempIntegral
    pdfCoefs[2] /= tempIntegral
    return polyInt(0,x,pdfCoefs[0],pdfCoefs[1],pdfCoefs[2])

def invCdf2(x):
    start = 0
    end = 1.0
    tempY = (start + end) / 2
    tempX = cdf2(tempY)
    while abs(tempX - x) > 0.0001:
        tempY = (start + end) / 2
        tempX = cdf2(tempY)
        if (tempX > x):
            end = tempY
        else:
            start = tempY
    return tempY

def primaryFoo2(x):
    return foo2(invCdf2(x)) / pdf2(invCdf2(x))


def polyApprox(x, regions):
    low = 0
    high = regionsBudget
    curr =  (low + high) // 2
    #print("Starting",len(regions))

    while (regions[curr][0] > x or regions[curr][1] < x):
        if (regions[curr][0] > x):
            high = curr
            curr = (low + high) // 2
        elif (regions[curr][1] < x):
            low = curr
            curr = (low + high) // 2
        #print(curr)
    return regions[curr][2] * x * x + regions[curr][3] * x + regions[curr][4]


def residual(x, regions):
    return foo(x) - polyApprox(x,regions)

print("Hello1")

myRegions = [[0, 0.0078125, -1805.3717256148083834, 93.815580715371368115, 1.1096824081330987077],
[0.0078125, 0.015625, -2728.667883796908427, 107.79610836531014684, 1.0568130611476203029],
[0.015625, 0.0234375, -3100.6505952562583843, 118.80567021642173131, 0.97560474888888748524],
[0.0234375, 0.03125, -2820.2542063938017236, 105.02232556322178425, 1.1446255525428554733],
[0.03125, 0.0625, 23.984296635931968922, -99.08792976382062534, 4.7454943683979529112],
[0.0625, 0.0703125, 2620.7666029296669876, -398.13233015990499553, 13.292088509193320078],
[0.0703125, 0.078125, 2725.7294960034778342, -412.27670234241850267, 13.76769412536003756],
[0.078125, 0.0859375, 2235.8027169136912562, -335.19811162211772171, 10.736204976617102602],
[0.0859375, 0.09375, 1309.0140516090323217, -175.59323281240722281, 3.8647303146171338994],
[0.09375, 0.109375, -309.64045843936037272, 131.94634873817994958, -10.740649801028268939],
[0.109375, 0.1171875, -1436.6651635996822733, 374.28118221511613228, -23.763548933062320856],
[0.1171875, 0.125, -1596.9823473228170769, 411.35970708461809409, -25.90706708563442362],
[0.125, 0.1328125, -1280.3320618452416966, 331.77814981861774868, -20.907033137971495762],
[0.1328125, 0.140625, -626.63988833695475478, 157.91311997773846088, -9.3461648036296196551],
[0.140625, 0.15625, 460.7433096399254282, -150.43785186602690374, 12.512263112845317892],
[0.15625, 0.1640625, 1030.0583311183945625, -325.65341112521809919, 25.990401730529811175],
[0.1640625, 0.171875, 870.32338859215087723, -272.81004610606396454, 21.620293361547169297],
[0.171875, 0.1875, -69.358925771965004969, 53.541146938934616628, -6.7121480118955645366],
[0.1875, 0.1953125, -1247.6529999639897142, 492.14003537646385666, -47.525038548118800463],
[0.1953125, 0.203125, -1770.6505740786669776, 696.07951368269277737, -67.406193745766586289],
[0.203125, 0.2109375, -1854.1692408257513307, 729.52178669953718781, -70.753194837014007135],
[0.2109375, 0.21875, -1430.1301385387778282, 550.14367570259491913, -51.783087046599007408],
[0.21875, 0.234375, -24.062140153197105974, -69.620286937060882337, 16.507729076831097359],
[0.234375, 0.2421875, 1617.3180884174653329, -834.48352560194325633, 105.60884179408731143],
[0.2421875, 0.25, 2405.4493944781715982, -1215.8306622103009431, 151.73867900952063792],
[0.25, 0.2578125, 2697.1596656643669121, -1361.1354563934146427, 169.8329856061600367],
[0.2578125, 0.265625, 2410.4155453925486654, -1212.7215290685126092, 150.62912317669270124],
[0.265625, 0.2734375, 1605.4361615087836981, -784.64146531105507165, 93.716997340336092748],
[0.2734375, 0.28125, 468.59872714872471988, -162.72984313342021778, 8.6621749364867355325],
[0.28125, 0.2890625, -736.40669265517499298, 515.0140600664599333, -86.635486311018510719],
[0.2890625, 0.296875, -1736.6803939806995913, 1092.97663782312884, -170.1227953406096276],
[0.296875, 0.3046875, -2318.9961560887168162, 1438.2449928103305865, -221.30207501431641504],
[0.3046875, 0.3125, -2381.1133623353671283, 1475.5798987739253789, -226.91093609030576772],
[0.3125, 0.3203125, -1952.3044015514897183, 1207.1479511101788376, -184.90182752193504712],
[0.3203125, 0.328125, -1178.5460524035152048, 711.22065306711010635, -105.43779705243196076],
[0.328125, 0.34375, 135.39390848824405111, -154.28763088597042952, 37.090428259981422343],
[0.34375, 0.3515625, 1046.3352504936628975, -777.20163830369710922, 143.57658863926940285],
[0.3515625, 0.359375, 1210.5998304652748629, -892.3430873940087622, 163.75352786764392476],
[0.359375, 0.375, 860.40242290681453596, -638.93429117827281516, 117.91287370964585079],
[0.375, 0.40625, -84.829141089445329271, 72.058804115486964292, -15.786348338539369252],
[0.40625, 0.421875, 417.64306368243705947, -337.45287682694834075, 67.650230436465562889],
[0.421875, 0.4375, 725.32457435115065891, -595.49585204676259309, 121.75141205325121518],
[0.4375, 0.453125, 6.2943684615020174533, 35.742049939071875997, -16.788294719484028406],
[0.453125, 0.4609375, -982.76722349203191698, 929.63328316499246284, -218.75639287240664999],
[0.4609375, 0.46875, -1538.7773323310466367, 1441.985338388960372, -336.78688189724744007],
[0.46875, 0.4765625, -1782.3770507468143478, 1669.9783478798926808, -390.13327634264896915],
[0.4765625, 0.484375, -1592.4648957876488566, 1488.5174946280894801, -346.78713293523560424],
[0.484375, 0.5, -494.9086703525390476, 421.2290773791319225, -87.327004229477097397],
[0.5, 0.5078125, 1065.6460042347898707, -1135.4420851948671043, 300.86990841070519309],
[0.5078125, 0.515625, 1970.077144504932221, -2053.7145063384668902, 533.95126682580576016],
[0.515625, 0.5234375, 2463.0551714587199967, -2561.5961286684323568, 664.76008396649012866],
[0.5234375, 0.53125, 2384.2430291761411354, -2478.4922130693448707, 642.85386610328896495],
[0.53125, 0.5390625, 1710.9731990073341876, -1762.598573039053008, 452.54999964068520057],
[0.5390625, 0.546875, 572.27047028671950102, -534.58601217716932297, 121.46825854607322981],
[0.546875, 0.5546875, -776.89098802604712546, 941.11334835016168654, -282.05805521065894936],
[0.5546875, 0.5625, -2015.6350434216437861, 2315.0770332291722298, -663.04396737699062214],
[0.5625, 0.5703125, -2836.6676348798791878, 3238.2024382263916777, -922.52216429683721799],
[0.5703125, 0.578125, -3024.751010409090668, 3452.0538331615971401, -983.30897619137613219],
[0.578125, 0.5859375, -2513.5505337100476027, 2860.3149901756551117, -812.06773410411005898],
[0.5859375, 0.59375, -1405.5952483403962106, 1561.4460832118056715, -431.3979937080257514],
[0.59375, 0.609375, 795.17160092719132081, -1057.9681651084101759, 348.02293441028109555],
[0.609375, 0.6171875, 2662.3144237322267145, -3327.4230026841396466, 1037.6310987418764853],
[0.6171875, 0.625, 3218.534090803397703, -4013.3457768008374842, 1249.0986371744038479],
[0.625, 0.6328125, 3069.3168685162672773, -3826.1285530694294721, 1190.3758497981980327],
[0.6328125, 0.640625, 2264.2650946122594178, -2806.6688987554516643, 867.63335667427963926],
[0.640625, 0.65625, 299.18104311742354184, -283.07872663217131048, 57.429665002144702157],
[0.65625, 0.6640625, -1646.0781427389010787, 2264.2541838742326945, -776.50433392133436428],
[0.6640625, 0.671875, -2450.5136701919836923, 3332.1222739816876128, -1130.8963099052853067],
[0.671875, 0.6796875, -2673.6965908470883733, 3631.4307418188545853, -1231.2458419356662489],
[0.6796875, 0.6875, -2319.5174169890815392, 3149.4518231510883197, -1067.2727540844825853],
[0.6875, 0.6953125, -1530.4213778644334525, 2064.1235932819545269, -694.08077079194845282],
[0.6953125, 0.703125, -541.61075252643786371, 688.99305620416998863, -215.98518271288412507],
[0.703125, 0.71875, 734.50587932264897972, -1108.0867139627807774, 416.69390873886641202],
[0.71875, 0.7265625, 1296.0843494484433904, -1912.5805698506301269, 704.81155252498319896],
[0.7265625, 0.734375, 1165.893721102969721, -1723.0572003282723017, 635.8377093709896144],
[0.734375, 0.75, 515.79954045217164094, -766.11720014012826141, 283.68500538944772416],
[0.75, 0.765625, -213.83776197512815997, 326.96154669374300283, -125.70307212059833546],
[0.765625, 0.78125, 41.117696989982505329, -65.512485345145250903, 25.33464943670651337],
[0.78125, 0.7890625, 690.52383606936200522, -1078.6842374388943426, 420.5090290757616458],
[0.7890625, 0.796875, 1048.5216744776116684, -1643.4665296173188835, 643.26107519887773378],
[0.796875, 0.8046875, 1146.5069651200901717, -1799.3149829738540575, 705.23119502180998097],
[0.8046875, 0.8125, 893.54638518253341317, -1391.8499941204208881, 541.14674552903215954],
[0.8125, 0.828125, -91.930712459608912468, 212.9278860391350463, -112.16641686009643308],
[0.828125, 0.8359375, -1330.6181092176120728, 2261.2002074138727039, -958.91124513398608542],
[0.8359375, 0.84375, -1958.4717116235988215, 3310.5973615482798778, -1397.4029156100441469],
[0.84375, 0.8515625, -2206.0264253017958254, 3727.9102661744691432, -1573.272996982690529],
[0.8515625, 0.859375, -1983.4276153459213674, 3348.3291504194494337, -1411.4554148337047081],
[0.859375, 0.875, -852.23989952052943408, 1400.0665897633880377, -572.57812647001446749],
[0.875, 0.8828125, 674.18245660327374935, -1267.2787072723731399, 592.68189202892085632],
[0.8828125, 0.890625, 1539.9586201417259872, -2795.6397200371138752, 1267.1885971319206874],
[0.890625, 0.8984375, 2038.8707134295254946, -3683.8975802812492475, 1662.5497502272774],
[0.8984375, 0.90625, 2068.9574503166950308, -3737.4887874198029749, 1686.4123890056653181],
[0.90625, 0.9140625, 1650.5892878562444821, -2978.805984108010307, 1342.4572944314786582],
[0.9140625, 0.921875, 918.6585095003247261, -1640.532626845408231, 730.72747427420836175],
[0.921875, 0.9375, -287.20684774877736345, 585.66408613993553445, -296.73870728031761246],
[0.9375, 0.9453125, -1041.4763437010115013, 1996.8905384219251573, -956.8313321180407911],
[0.9453125, 0.953125, -1070.5459727853885852, 2051.4719674326479435, -982.45076162809164089],
[0.953125, 0.96875, -495.28833942795972689, 952.59517206648160936, -457.67504009814638266],
[0.96875, 0.984375, 502.26083857409685152, -979.4320399792122771, 477.79979807504059863],
[0.984375, 1, 527.09521225388743915, -1025.5825160015956499, 499.16481032773890547]]

myRegions = [[0, 0.015625, -2295.5621932918584207, 97.645193744098293109, 1.1096824081330987077],
[0.015625, 0.0234375, -3100.6505952562583843, 118.80567021642173131, 0.97560474888888748524],
[0.0234375, 0.03125, -2820.2542063938017236, 105.02232556322178425, 1.1446255525428554733],
[0.03125, 0.046875, -1317.6221393460727995, 5.7250730472737814125, 2.7802505656899292319],
[0.046875, 0.0625, 1340.0800525379381725, -243.03590306560272438, 8.6012436532671188161],
[0.0625, 0.0703125, 2620.7666029296669876, -398.13233015990499553, 13.292088509193320078],
[0.0703125, 0.078125, 2725.7294960034778342, -412.27670234241850267, 13.76769412536003756],
[0.078125, 0.09375, 1792.4453097313089529, -262.45978700626437785, 7.7595622282006502246],
[0.09375, 0.109375, -309.64045843936037272, 131.94634873817994958, -10.740649801028268939],
[0.109375, 0.125, -1548.5559196602698648, 399.63143163508993894, -25.197695586670803891],
[0.125, 0.140625, -968.08093526657830807, 251.27590624755157478, -15.723176544379853681],
[0.140625, 0.15625, 460.7433096399254282, -150.43785186602690374, 12.512263112845317892],
[0.15625, 0.171875, 977.73242802981985733, -308.89277029216827941, 24.649039468739189829],
[0.171875, 0.1875, -69.358925771965004969, 53.541146938934616628, -6.7121480118955645366],
[0.1875, 0.203125, -1531.9645282870478695, 600.97804231267946307, -57.936837681051940763],
[0.203125, 0.21875, -1673.2930317385762464, 654.62773137440308346, -63.00324984317308008],
[0.21875, 0.234375, -24.062140153197105974, -69.620286937060882337, 16.507729076831097359],
[0.234375, 0.25, 2037.2374863958102651, -1034.6013637010619277, 129.44459863735733052],
[0.25, 0.2578125, 2697.1596656643669121, -1361.1354563934146427, 169.8329856061600367],
[0.2578125, 0.265625, 2410.4155453925486654, -1212.7215290685126092, 150.62912317669270124],
[0.265625, 0.28125, 1050.0510610854253173, -485.25418461392837344, 53.378357844219181061],
[0.28125, 0.296875, -1257.0655159347224981, 811.95229521800501971, -128.96443849657015335],
[0.296875, 0.3125, -2383.1918211810843786, 1476.8626975927472813, -227.10883622453491171],
[0.3125, 0.328125, -1580.6799866703513544, 971.9793760682005086, -147.70309458705423822],
[0.328125, 0.34375, 135.39390848824405111, -154.28763088597042952, 37.090428259981422343],
[0.34375, 0.359375, 1151.3208974217996001, -850.19947093343944289, 156.26406306051808315],
[0.359375, 0.375, 860.40242290681453596, -638.93429117827281516, 117.91287370964585079],
[0.375, 0.390625, 65.701922682361328043, -43.191541584801598219, 6.2641004561585305055],
[0.390625, 0.40625, -119.7046738475728489, 99.85024428212273051, -21.320795675645399569],
[0.40625, 0.421875, 417.64306368243705947, -337.45287682694834075, 67.650230436465562889],
[0.421875, 0.4375, 725.32457435115065891, -595.49585204676259309, 121.75141205325121518],
[0.4375, 0.453125, 6.2943684615020174533, 35.742049939071875997, -16.788294719484028406],
[0.453125, 0.46875, -1274.8371650311237318, 1196.6034641026308236, -279.75879399201380693],
[0.46875, 0.484375, -1716.274128870543791, 1607.4904295435699169, -375.36663241758628828],
[0.484375, 0.5, -494.9086703525390476, 421.2290773791319225, -87.327004229477097397],
[0.5, 0.515625, 1536.4507387888443191, -1609.9249817375384737, 420.4101730435047557],
[0.515625, 0.53125, 2461.8861656752997078, -2560.3814585967629682, 664.44457227381963094],
[0.53125, 0.546875, 1163.9374480994301848, -1177.0993708956521004, 295.89156804531148737],
[0.546875, 0.5625, -1413.4151165204239078, 1642.2844586446008179, -475.14429291924329846],
[0.5625, 0.5703125, -2836.6676348798791878, 3238.2024382263916777, -922.52216429683721799],
[0.5703125, 0.578125, -3024.751010409090668, 3452.0538331615971401, -983.30897619137613219],
[0.578125, 0.59375, -1990.5365340278949589, 2251.4940061713568866, -634.8992954913783251],
[0.59375, 0.609375, 795.17160092719132081, -1057.9681651084101759, 348.02293441028109555],
[0.609375, 0.6171875, 2662.3144237322267145, -3327.4230026841396466, 1037.6310987418764853],
[0.6171875, 0.625, 3218.534090803397703, -4013.3457768008374842, 1249.0986371744038479],
[0.625, 0.6328125, 3069.3168685162672773, -3826.1285530694294721, 1190.3758497981980327],
[0.6328125, 0.640625, 2264.2650946122594178, -2806.6688987554516643, 867.63335667427963926],
[0.640625, 0.65625, 299.18104311742354184, -283.07872663217131048, 57.429665002144702157],
[0.65625, 0.671875, -2081.7579730387660675, 2839.4877098166616634, -966.3696896548026416],
[0.671875, 0.6875, -2529.6696731323027052, 3436.7693608471890911, -1165.4737839328818154],
[0.6875, 0.703125, -1040.2247830726555549, 1386.2736145463422872, -459.75339466831064783],
[0.703125, 0.71875, 734.50587932264897972, -1108.0867139627807774, 416.69390873886641202],
[0.71875, 0.734375, 1252.7562485721718986, -1849.9579240527236834, 682.18489047050343288],
[0.734375, 0.75, 515.79954045217164094, -766.11720014012826141, 283.68500538944772416],
[0.75, 0.765625, -213.83776197512815997, 326.96154669374300283, -125.70307212059833546],
[0.765625, 0.78125, 41.117696989982505329, -65.512485345145250903, 25.33464943670651337],
[0.78125, 0.796875, 881.23773502935364377, -1378.1646568981959717, 538.07558055764138771],
[0.796875, 0.8125, 1042.8462282128748484, -1633.2958340208278969, 638.76026594773929901],
[0.8125, 0.828125, -91.930712459608912468, 212.9278860391350463, -112.16641686009643308],
[0.828125, 0.84375, -1663.4625032291805837, 2815.0740818233753089, -1189.3263523651348805],
[0.84375, 0.859375, -2124.6481434208690189, 3589.948647674289532, -1514.8022246263280977],
[0.859375, 0.875, -852.23989952052943408, 1400.0665897633880377, -572.57812647001446749],
[0.875, 0.890625, 1124.6722011672682129, -2059.1552113888901658, 940.66762244905339685],
[0.890625, 0.90625, 2084.0515671028078941, -3764.7289513067225926, 1698.7021545036586758],
[0.90625, 0.921875, 1298.2176957968622446, -2337.3795704360236414, 1050.563541535191689],
[0.921875, 0.9375, -287.20684774877736345, 585.66408613993553445, -296.73870728031761246],
[0.9375, 0.953125, -1080.2248207955562975, 2069.846655451663537, -991.17141313694003202],
[0.953125, 0.96875, -495.28833942795972689, 952.59517206648160936, -457.67504009814638266],
[0.96875, 0.984375, 502.26083857409685152, -979.4320399792122771, 477.79979807504059863],
[0.984375, 1, 527.09521225388743915, -1025.5825160015956499, 499.16481032773890547]]

# plt.plot(np.arange(0,1,0.001), foo(np.arange(0,1,0.001)), linestyle='-', label='Foo')
# plt.show()

x = np.linspace(0.0, 1.0, 1000)
#for i in range(0, 1000):
foo_vec = np.vectorize(foo)
foo2_vec = np.vectorize(primaryFoo)
#foo22_vec = np.vectorize(primaryFoo2)
pdf_vec = np.vectorize(pdf)
#pdf2_vec = np.vectorize(pdf2)

print("Hello2")

plt.subplot(1, 2, 1)
y = [0] * 1000
y2 = [0] * 1000
for i in range(0,1000):
    y[i] = foo(x[i])
    y2[i] = pdf(x[i])
    #y2[i] = invCdf(x[i])
plt.plot(x, y)
plt.plot(x, y2)

print("Hello3")

plt.subplot(1, 2, 2)
y = [0] * 1000
y2 = [0] * 1000
plt.xticks(np.linspace(0.0, 1.0, 11))
for i in range(0,1000):
    #y[i] = foo(invCdf(x[i]))
    #y[i] = foo2(x[i])
    #y2[i] = pdf(invCdf(x[i]))
    y[i] = foo(x[i])
    #y2[i] = polyApprox(x[i],myRegions)
plt.plot(x, y)
#plt.plot(x, y2)
plt.show()

print("Hello4")

#plt.subplot(1, 2, 1)
y = foo_vec(x)
y2 = pdf_vec(x)
#plt.plot(x, y)
#plt.plot(x, y2)

est = 0
x = np.linspace(0.0, 1.0, 1000)
y = [0] * 1000
y2 = [0] * 1000
#fooCoefs = [0.34252596485104030988,40.373478800639617248,0.41481951205383099657,1.5401418457083917435,0.90731319362333173739,20.79972175384445876,0.65148028737933372234,51.340066572970592063]
#fooCoefs = [0.702400453854602147,50.504023186394000788,0.45295555709445656234,62.096501157973911234,0.22370818963690680681,24.208689887070761415,0.87206685308697196035,47.328547906014968305]
#fooCoefs = [0.60552367758166736333,10.994924155005476152,0.066656109992848516788,1.1645257770499917171,0.76824161565090720583,35.077295830035957636,0.82686686508002282814,7.6933851758133062759]
for i in range(0,1000):
    y[i] = foo2(x[i])
    #y[i] = residual(x[i],myRegions)
    #est += foo2(x[i])
    y2[i] = pdf2(x[i])
#est /= 10000
#print(est)
#plt.xticks(np.linspace(0.0, 1.0, 21))
#plt.plot(x, y)
#plt.plot(x, y2)

print("Hello5")

#plt.subplot(1, 2, 2)
#y = foo22_vec(x)
#y = foo_vec(x)
y = [0] * 1000
y2 = [0] * 1000
#est = 0
for i in range(0,1000):
    #y[i] = foo2(invCdf2(x[i]))
    y[i] = foo2(x[i])
    y2[i] = polyApprox(x[i],myRegions)
    #y2[i] = pdf2(invCdf2(x[i]))
    #y2[i] = primaryFoo2(x[i])
    #est += primaryFoo2(x[i])
#est /= 10000
#print(est)
plt.plot(x, y)
plt.plot(x, y2)
for i in range(regionsBudget):
    plt.axvline(x=myRegions[i][1], linestyle='--', color='red')
plt.show()

print(foo(invCdf(0.9)))
print(pdf(invCdf(0.9)))
print(invCdf(0.9))

x = np.linspace(0.0, 0.25, 100)
y = -2.08897 * x**2 - 0.560147 * x + 0.783074
#plt.plot(x, y, color='orange')
#plt.axvline(x=0.25, linestyle='--', color='red')

x = np.linspace(0.25, 0.5, 100)
y = -3.38676 * x**2 + 3.61422 * x + -0.169406
#plt.plot(x, y, color='orange')
#plt.axvline(x=0.5, linestyle='--', color='red')

x = np.linspace(0.5, 0.625, 100)
y = 8.45619 * x**2 + -6.32399 * x + 1.83896
#plt.plot(x, y, color='orange')
#plt.axvline(x=0.625, linestyle='--', color='red')

x = np.linspace(0.625, 0.75, 100)
y = -6.11312 * x**2 + 3.64454 * x + 1.29977
#plt.plot(x, y, color='orange')
#plt.axvline(x=0.75, linestyle='--', color='red')

x = np.linspace(0.75, 0.875, 100)
y = -50.6355 * x**2 + 83.3905 * x + -33.4658
#plt.plot(x, y, color='orange')
#plt.axvline(x=0.875, linestyle='--', color='red')

x = np.linspace(0.875, 0.9375, 100)
y = -317.799 * x**2 + 571.103 * x + -255.667
#plt.plot(x, y, color='orange')
#plt.axvline(x=0.9375, linestyle='--', color='red')

x = np.linspace(0.9375, 1, 100)
y = -360.013 * x**2 + 702.895 * x + -342.12
#plt.plot(x, y, color='orange'

x2 = np.linspace(0, 1, 1000)
y2 = 1000 * [0]
#for i in range(1000):
#    y2[i] = polyApprox(x2[i], myRegions)

#y = polyApprox_vec(x, myRegions)
#plt.plot(x2, y2, color='red')

#plt.show()

x3 = [11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,55,57,59,63,67,69,73,77,81,85,89,93,99,103,109,115,121,127,133,141,147,155,163,171,181,189,199,209,219,231,243,255,269,283,297,313,329,345,363,381,401,421,443,465,489,515,541,569,597,629,661,695,731,767,807,849,891,937,985,1037,1089,1145,1203,1265,1331,1399,1471,1545,1625,1709,1795,1887,1985,2087,2193,2305,2423,2549,2679,2817,2961,3113,3271,3439,3617]
y3 = [0.27354943163660988548,0.20009168635514038015,0.18945269270089937219,0.16356810162076296233,0.16713662249459668163,0.12589723208332473381,0.15118692322203711176,0.12010629017606354318,0.12672219107573465258,0.10836029219049626848,0.094435556486720140246,0.094841544420591880615,0.089871189298420209313,0.076366556977570179687,0.092086637296048226564,0.085035879220136528778,0.069513885824438140237,0.065383787256700659496,0.06972412928706848978,0.063522457186532335638,0.065188055574057809927,0.05599611183771885381,0.0596279653557413164,0.055260731053440849403,0.04646788588998036762,0.043233739655648625866,0.042924543701610966273,0.043591251202316154412,0.037681273485599270368,0.037786300587404758611,0.02555870003377403582,0.027781039373573485074,0.030437116456890688648,0.026462655013760126577,0.029532424243963639049,0.016582836725219769758,0.020887191215743075579,0.016663947353975531313,0.022251265172245373453,0.016987863131057334004,0.020407965396499163496,0.013837198924689105006,0.011579649644814563741,0.012229610330971868101,0.016573954836625597042,0.0091662821165309042726,0.0054506822282501254939,0.010911917776572134867,0.0093051911318283928032,0.0050781945100231646109,0.0069542878217764012364,0.0022234837475442240616,0.0041634538757811109452,0.0052436854133681562104,0.0057423349433208571713,0.0018241686023004835028,0.0017755801572005148851,0.012339040058888426157,0.00084647130772029532432,0.0017605294302423428812,0.0018658517407818954285,0.0028832431937128046549,0.00093543000013510764403,0.0023904478520142772441,0.002117825336818270586,9.2886461753815906641e-05,0.0015071581397415414506,0.00015698587204660349606,0.00022463299008047992226,6.2851508840061379667e-05,0.0001597566633451967717,0.0016975496975699219844,1.9175182904783185772e-05,0.0011729691168182465339,0.0028500094168024004554,0.00010987746465637594892,0.00020612146994828110975,1.4699149948989710494e-05,4.2771459932051822611e-05,7.9762821387413143203e-06,4.3113426081600556168e-05,5.7633449374612630203e-06,7.4593378108798322136e-05,8.1057364681268940696e-05,8.3542841410727497161e-06,4.561576052826192158e-06,4.9916046611829265685e-06,6.0116929087336699498e-06,4.9576054396185455049e-06,8.8446127786691835219e-06,5.957502580132979691e-06,6.0434581614975945731e-06,1.1734743450094704557e-05,1.8030922175756250599e-05,6.6769466745685116614e-06,2.1082104638775562232e-05,1.0549043341876264602e-05,1.3544108325437127525e-05,6.468281741250582962e-06,6.2076303165307939789e-06,1.6553215729006533121e-05,1.6434227732947082295e-05,7.467785719211465446e-06,5.5603319448493552851e-06,1.2705936753415755528e-05,6.0031808585085553933e-06]
y4 = [0.27354943163660988548,0.19357272396233859979,0.20071384645920761769,0.18389610425074273681,0.19570230080784598026,0.16286083115601529547,0.17609482680860899517,0.093001647334248899179,0.094521193353742219423,0.069311558684451782253,0.071045559446378386825,0.065895236321646843969,0.064996762691129431055,0.057744477266457039377,0.059754760164119825883,0.058435487076895921421,0.054206718824296784565,0.040592787724541050387,0.045317310825542689301,0.019749964192588283923,0.019859907386484111635,0.014369241072710607979,0.011975733157815995206,0.012506592405159994499,0.011504685667090723544,0.0097808534505338298043,0.008673270612036442645,0.008704446525827939582,0.0079660069795175428992,0.0074191840363725374691,0.0069067629669145157861,0.007190842981965325266,0.0062693591319947540585,0.0059883244031870216939,0.0056244679537867259961,0.0049713217507421853317,0.0048740337405697225712,0.0049127345802560907703,0.0046629956908168096463,0.004603164722819012844,0.0041029887158811053846,0.0037189857547994405705,0.0038491782094890432744,0.003545973928698825748,0.0032605334045953042292,0.0031327669704752365669,0.0028966452614590850606,0.0028556805989734886271,0.0026816415165944445381,0.0026489734021141885141,0.0025773205153266803315,0.0024167266879205253488,0.0022355950531450195784,0.0020299981656885638694,0.0019757351014008999943,0.0019022584699827441157,0.0018333250672373383253,0.001781700322526992954,0.0016351646399829166366,0.0015934378772142062872,0.0014464293946077014935,0.0014314754489841085509,0.001358358348668057148,0.0013064828453086916194,0.0012629820010240696681,0.0012253420214998760225,0.0010861072688128294191,0.0010000823214915558271,0.0010546887380092561607,0.00097557559516124852782,0.00089177865896905637692,0.0008642852683333390653,0.00080301717347174223285,0.0007798479800307921584,0.00073340613508956619283,0.00072918336007800311441,0.00066866836712021094236,0.00065496162153302667133,0.00060608331508138382597,0.00059167306924498336198,0.00057091031936009858146,0.00050079315425739659787,0.00047464765569684157394,0.00046817920035082934236,0.00044819330286126839559,0.00040391105687512290001,0.00043315085877109821754,0.00036179045593639607694,0.00037266641368560293052,0.00034786518559495118201,0.00032934221466512366783,0.0003082055338252440266,0.00028704330890720017614,0.0002885607565722040713,0.00027926551083882594209,0.00025385041553600612083,0.00025269486118015727256,0.00025077961698497631222,0.00021240129005944285599,0.00021717226072144482727,0.00018956840052724801713,0.00020000449401921433531,0.00017315174510148617594,0.00016930011782754914506,0.0001534329028480183293,0.00015607819468720703516]
plt.scatter(x3, y3)
plt.scatter(x3, y4)
logX = np.log(x3)
logY = np.log(y3, out=np.zeros_like(y3), where=(y3!=0))
m, b = np.polyfit(logX, logY, 1)
print("Slope: ",m)
plt.yscale('log')
plt.xscale('log')
plt.show()

# for x1 in np.arange(0.0,1.0,0.1):
#    for x2 in np.arange(0.0,1.0,0.1):
#        for x3 in np.arange(0.0,1.0,0.1):
#            if (w1Formula(x1,x2,x3) < 0):
#                print(w1Formula(x1,x2,x3))
